<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="corp_layout :: site-head">

    <link rel="stylesheet" type="text/css" href="css/jquery.dataTables.css"/>
    <link rel="stylesheet" type="text/css" href="css/select.bootstrap.css"/>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/dataTables.bootstrap.css"/>
</head>

<style>
    .hstyle{
        width: 100%;
        text-align: center;
        border-bottom: 1px solid #000;
        line-height: 0.1em;
        margin: 10px 0 20px;
    }

    .hstyle span {
        background:#fff;
        padding:0 10px;
    }
    table.dataTable tbody > tr.selected{
        color: black;
        background-color: #d7bdb3;
    }
</style>

<body>
<header th:replace="corp_layout ::corp-header">
</header>

<section class="content-wrapper">
    <div class="container">
        <div class="row">
            <div class="col-md-4 col-sm-4">
                <h5 class="page_header"> Bulk Transfer </h5>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 content-bg">
                <form method="post" th:action="@{/corporate/bulktransfer}" id="" class="form-horizontal">
                <div class="row spacing">
                    <div>
                        <p>To make a bulk transfer, Enter the request fields below</p>
                    </div>

                    <br/>
                    <div class="form-group">
                        <label>Source account</label>


                        <span id="scurency"></span>
                        <select name="debitAccount" class="form-control" id="debitAccount">
                            <!--<option value=""> select an account</option>-->
                            <option th:each="s: ${accounts}" th:value="${s}" th:text="${s}"></option>
                        </select>
                        <input type="hidden" name="requests"/>
                    </div></div>
                </form>

                    <div class="col-md-6 col-sm-6 col-xs-12">
                        <button type="submit" id="button_add" class="btn-xs btn-success btn">Add Field</button>
                        <button type="submit" id="button_del" class="btn-xs btn-warning btn">Remove</button>
                    </div>
                    <br/>

                        <br/>
                        <table id="mytab" class="table table-striped table-bordered table-hover" cellspacing="0"  >
                            <thead>

                                <th>Serial</th>
                                <th>Ref</th>
                                <th>Account Number</th>
                                <th>Sort Code</th>
                                <th>Beneficiary Name</th>
                                <th>Amount (N)</th>
                                <th>Narration</th>
                            </thead>

                        </table>

                    <br/>
                    <button class="btn btn-link" type="submit" id="button_submit">Upload</button>
                    </div>



            <!--<div th:replace="corp_layout :: corp-sidebar" class="col-md-3 sidebar">-->
            <!--</div>-->
            </div>
        </div>

</section>


<!-- CONTENT-WRAPPER SECTION END-->
<footer th:replace="corp_layout ::corp-footer">
</footer>
<script type="text/javascript" language="javascript" src="js/jquery.js">
</script>

<script type="text/javascript" language="javascript" src="js/jquery.dataTables.js">
</script>

<script type="text/javascript" language="javascript" src="js/dataTables.select.js">
</script>
<script type="text/javascript" language="javascript" src="js/bootstrap.js">
</script>


<script th:inline="javascript">
    //<![CDATA[
    //datepicker
    $( function() {
        $( "#datepicker" ).datepicker(
            { dateformat : 'dd/mm/yy'}
        );
    } );



    $(document).ready(function() {
        t = $('#mytab').DataTable({dom : 'rt',
            select : {style:'single'},
            ordering : false,
            "language": {
                "emptyTable": "Enter Bulk transfer request fields"
            }
        });

        t.on('select', function (e,dt,type, indexed) {
            if(type == 'row'){

                dt.rows({selected: true}).every(function (rowIdx,tableLoop,rowLoop) {
                    this.data();
                    inparray = [];
                    for(i =0; i < this.data().length; i++){
                        inp = '<input value="' +this.data()[i]+'"/>';
                        inparray.push(inp);
                    }
                    this.data(inparray).draw();
                });

//                dt.rows({selected: true}).each(function (value,index) {
//                    rw = value;//dt.row(index);
//                    arr = rw.data;
//                    inparray = [];
//                    for(i =0; i < arr.length; i++){
//                        inp = '<input value="' +arr[i]+'"/>';
//                        inparray.push(inp);
//                    }
//                    //rw.add(inparray);
//                });


            }
        });

        t.on('deselect', function (e,dt,type, indexed) {
            if(type == 'row'){

                dt.rows({selected: false}).every(function (rowIdx,tableLoop,rowLoop) {
                    rw = dt.row(index);
                    arr = rw.data;
                    inparray = [];

                    for(i =0  ; i < arr.length; i++){

                        d= $(arr[i]).val();
                        inparray.push(d);
                    }

                    rw.add(inparray);
                });


            }
        });

        $('#button_add').on( 'click', function (e) {
            e.preventDefault();
            t.row.add( [
                '',
                '',
                '',
                '',
                '',
                '',
                ''
            ] ).draw( false );

        } );

        $('#button_del').click( function (e) {
            e.preventDefault()
            var dt = $('#mytab').DataTable();
            dt.row('.selected').remove().draw( false );


        } );

        $('#button_submit').click(function(e) {
            e.preventDefault()
            bulkTab = $('#mytab').DataTable();
            data = JSON.stringify(bulkTab.data().toArray());
            $("input[name='requests']").val(data);
            $('form').submit();
        });
    } );

    //]]>

</script>
</body>
</html>